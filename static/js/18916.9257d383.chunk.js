"use strict";(self.webpackChunkimage_editor=self.webpackChunkimage_editor||[]).push([[18916],{18916:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Be});var o=t(36663),r=t(16911),i=t(70049),s=t(69737);function a(e){const n=e.toToken.chainId===e.onRampToken.token.chainId,t=(0,s.bv)(e.toToken.tokenAddress)===(0,s.bv)(e.onRampToken.token.tokenAddress);return!(n&&t)}var c=t(49199),d=t(14258),l=t(46104),u=t(87416),h=t(89267),x=t(36660),m=t(7469);var p=t(3692),y=t(64134);function f(e,n){return(0,x.I)({...n,queryKey:["useBuyWithFiatQuote",e],queryFn:async()=>{if(!e)throw new Error("No params provided");return async function(e){try{const n=new URLSearchParams({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress.toLowerCase()});e.fromAmount&&n.append("fromAmount",e.fromAmount),e.toAmount&&n.append("toAmount",e.toAmount),e.maxSlippageBPS&&n.append("maxSlippageBPS",e.maxSlippageBPS.toString()),e.isTestMode&&n.append("isTestMode",e.isTestMode.toString());const t=n.toString(),o="".concat((0,y._5)(),"?").concat(t),r=await(0,p.KI)(e.client)(o);if(!r.ok){const e=await r.json();if(e&&"error"in e)throw e;throw new Error("HTTP error! status: ".concat(r.status))}return(await r.json()).result}catch(n){throw console.error("Fetch error:",n),n}}(e)},enabled:!!e,retry(e,n){if(e>3)return!1;try{if("MINIMUM_PURCHASE_AMOUNT"===n.error.code)return!1}catch{return!0}return!0}})}var g,j=t(80502),v=t(67902),b=t(63617),w=t(46420),k=t(32094),C=t(43472),T=t(60033),S=t(99075),E=t(37169),F=t(25446),A=t(6287);const R=(0,r.forwardRef)((function(e,n){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(B,{ref:n,children:[(0,o.jsx)(F.w,{children:(0,o.jsx)(A.K0,{type:"button","aria-label":"Close",onClick:e.close,children:(0,o.jsx)(C.MKb,{width:l.RK.md,height:l.RK.md,style:{color:"inherit"}})})}),e.children]})})})),B=(0,E.jx)((()=>{const e=(0,T.QP)();return{zIndex:1e4,padding:l.YK.lg,borderTopLeftRadius:l.r8.xl,borderTopRightRadius:l.r8.xl,background:e.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(W," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(e.colors.borderColor)}})),W=(0,k.i7)(g||(g=(0,w.A)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]))),z=(0,E.jx)((()=>({backgroundColor:(0,T.QP)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(S.I0," 400ms cubic-bezier(0.16, 1, 0.3, 1)")})));var D=t(12296),L=t(36491),M=t(23700),I=t(12167),P=t(824),N=t(77802),K=t(58008),q=t(56043),O=t(52394),_=t(73166),Y=t(13283),V=t(95470);function U(e){const{estimatedSeconds:n,quoteIsLoading:t}=e;return(0,o.jsxs)(K.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:l.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(K.mc,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(C.O4,{width:l.RK.sm,height:l.RK.sm}),t?(0,o.jsx)(L.E,{height:l.J.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(q.E,{size:"xs",color:"secondaryText",children:void 0!==n?"~".concat((0,V.X)(n)):"--"})]}),(0,o.jsxs)(A.$n,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(K.mc,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(Q,{size:l.RK.sm})}),(0,o.jsx)(q.E,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}const Q=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var $=t(57764);function H(e){return(0,o.jsxs)(K.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:l.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(G,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,o.jsx)(e.currency.icon,{size:l.RK.md}),(0,o.jsxs)(K.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(q.E,{color:"primaryText",children:e.currency.shorthand}),(0,o.jsx)(C.D3D,{width:l.RK.sm,height:l.RK.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:l.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:l.YK.sm},children:e.isLoading?(0,o.jsx)(L.E,{width:"100px",height:l.J.lg}):(0,o.jsx)(q.E,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?"".concat((0,c.Z)(Number(e.value),4)):"--"})})]})}const G=(0,$.A)(A.$n)((()=>({"&[disabled]:hover":{borderColor:"transparent"}})));function J(e){return(0,o.jsxs)("div",{children:[(0,o.jsx)(q.E,{size:"sm",children:"Pay with "}),(0,o.jsx)(M.h,{y:"xs"}),(0,o.jsxs)(K.mc,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:l.YK.sm},children:[(0,o.jsx)(Z,{isChecked:"creditCard"===e.selected,variant:"outline",onClick:()=>{e.onSelect("creditCard")},children:"Credit Card"}),(0,o.jsx)(Z,{isChecked:"crypto"===e.selected,variant:"outline",onClick:()=>{e.onSelect("crypto")},children:"Crypto"})]})]})}const Z=(0,$.A)(A.$n)((e=>{const n=(0,T.QP)();return{fontSize:l.J.sm,borderColor:e.isChecked?n.colors.accentText:n.colors.borderColor,"&:hover":{borderColor:e.isChecked?n.colors.accentText:n.colors.secondaryText},gap:l.YK.xs,paddingInline:l.YK.xxs,paddingBlock:l.YK.sm,width:"100%"}}));var X=t(48666);function ee(e){return(0,o.jsxs)(K.mc,{children:[(0,o.jsx)(K.mc,{p:"lg",children:(0,o.jsx)(K.rQ,{title:"Select Currency",onBack:e.onBack})}),(0,o.jsx)(K.N1,{}),(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(K.mc,{flex:"column",gap:"xs",px:"lg",children:X.qx.map((n=>(0,o.jsxs)(ne,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(n),gap:"sm",children:[(0,o.jsx)(n.icon,{size:l.RK.lg}),(0,o.jsxs)(K.mc,{flex:"column",gap:"xxs",children:[(0,o.jsx)(q.E,{color:"primaryText",children:n.shorthand}),(0,o.jsx)(q.E,{size:"sm",children:n.name})]})]},n.shorthand)))}),(0,o.jsx)(M.h,{y:"lg"})]})}const ne=(0,$.A)(A.$n)((()=>{const e=(0,T.QP)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:l.YK.sm,padding:l.YK.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}}));function te(e,n){const t=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open("".concat(e,"&theme=").concat(n),"thirdweb Pay","width=".concat(500,", height=").concat(750,", top=").concat(t,", left=").concat(o))}var oe=t(62158),re=t(18058),ie=t(90772),se=t(11454),ae=t(51050),ce=t(94057),de=t(60341),le=t(70829),ue=t(76151);function he(e){var n,t,i,s;const a=(0,re.jE)(),{openedWindow:c}=e,d=(0,se.a)({intentId:e.intentId,client:e.client});let l="loading";"ON_RAMP_TRANSFER_FAILED"===(null===(n=d.data)||void 0===n?void 0:n.status)||"PAYMENT_FAILED"===(null===(t=d.data)||void 0===t?void 0:t.status)?l="failed":"CRYPTO_SWAP_FALLBACK"===(null===(i=d.data)||void 0===i?void 0:i.status)?l="partialSuccess":"ON_RAMP_TRANSFER_COMPLETED"===(null===(s=d.data)||void 0===s?void 0:s.status)&&(l="completed"),(0,r.useEffect)((()=>{var e,n;c&&d.data&&("CRYPTO_SWAP_REQUIRED"!==(null===(e=d.data)||void 0===e?void 0:e.status)&&"ON_RAMP_TRANSFER_COMPLETED"!==(null===(n=d.data)||void 0===n?void 0:n.status)||c.close())}),[d.data,c]);const u=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{var e;u.current||"ON_RAMP_TRANSFER_COMPLETED"!==(null===(e=d.data)||void 0===e?void 0:e.status)||(u.current=!0,(0,ae.V)(a))}),[d.data,a]),(0,r.useEffect)((()=>{var n;"CRYPTO_SWAP_REQUIRED"===(null===(n=d.data)||void 0===n?void 0:n.status)&&e.onShowSwapFlow(d.data)}),[d.data,e.onShowSwapFlow]),(0,o.jsxs)(K.mc,{p:"lg",children:[(0,o.jsx)(K.rQ,{title:"Buy",onBack:e.onBack}),e.hasTwoSteps&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(ce.g,{steps:2,currentStep:1}),(0,o.jsx)(M.h,{y:"sm"}),(0,o.jsxs)(q.E,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,o.jsx)(xe,{uiStatus:l,onDone:e.onDone,fiatStatus:d.data,client:e.client,isBuyForTx:e.isBuyForTx,quote:e.quote,isEmbed:e.isEmbed})]})}function xe(e){const{uiStatus:n}=e,t=e.fiatStatus?(0,le.A)(e.fiatStatus):void 0,r=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,i=e.quote.onRampToken,s=(0,o.jsx)(ue.i,{client:e.client,token:null!==r&&void 0!==r&&r.source?{chainId:r.source.token.chainId,address:r.source.token.tokenAddress,symbol:r.source.token.symbol||"",amount:r.source.amount}:{chainId:i.token.chainId,address:i.token.tokenAddress,symbol:i.token.symbol,amount:i.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:null!==r&&void 0!==r&&r.source&&t?{color:null===t||void 0===t?void 0:t.color,text:null===t||void 0===t?void 0:t.status,txHash:r.source.transactionHash}:void 0});return(0,o.jsxs)(K.mc,{children:[(0,o.jsx)(M.h,{y:"xl"}),"loading"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(K.mc,{flex:"row",center:"x",children:(0,o.jsx)(I.y,{size:"3xl",color:"accentText"})}),(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(q.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,o.jsx)(M.h,{y:"sm"}),!(0,ie.Fr)()&&(0,o.jsx)(q.E,{center:!0,children:"Complete the purchase in popup"}),(0,o.jsx)(M.h,{y:"xxl"}),s]}),"failed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(K.mc,{flex:"row",center:"x",children:(0,o.jsx)(de.g,{size:l.RK["3xl"]})}),(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(q.E,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,o.jsx)(M.h,{y:"xxl"}),s]}),"completed"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(K.mc,{flex:"row",center:"x",color:"success",children:(0,o.jsx)(C.KaV,{width:l.RK["3xl"],height:l.RK["3xl"]})}),(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(q.E,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"xxl"}),s,(0,o.jsx)(M.h,{y:"sm"})]}),!e.isEmbed&&(0,o.jsx)(A.$n,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.isBuyForTx?"Continue Transaction":"Done"})]})]})}var me=t(65258),pe=t(44161);function ye(e){const n=a(e.quote),[t,i]=(0,r.useState)(n?{id:"step-1"}:{id:"onramp-status"}),[s,c]=(0,r.useState)(e.openedWindow);return"step-1"===t.id?(0,o.jsx)(me.Y,{client:e.client,onBack:e.onBack,partialQuote:(0,me.z)(e.quote),step:1,onContinue:()=>{const n=te(e.quote.onRampLink,e.theme);(0,oe.b)({type:"fiat",intentId:e.quote.intentId}),c(n),i({id:"onramp-status"})}}):"onramp-status"===t.id?(0,o.jsx)(he,{client:e.client,intentId:e.quote.intentId,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,hasTwoSteps:n,openedWindow:s,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{i({id:"postonramp-swap",data:e})},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):"postonramp-swap"===t.id?(0,o.jsx)(pe.n,{status:t.data,quote:(0,me.z)(e.quote),client:e.client,onBack:e.onBack,onViewPendingTx:e.onViewPendingTx,onDone:e.onDone,onSwapFlowStarted:()=>{},isBuyForTx:e.isBuyForTx,isEmbed:e.isEmbed}):null}var fe=t(99217),ge=t(88120);var je=t(8389),ve=t(52187);var be=t(57063),we=t(86077);function ke(e){var n;const t=(0,u.r)(e.chain);return(0,o.jsxs)(K.mc,{children:[(0,o.jsx)("div",{onClick:e=>{var n;null===(n=e.currentTarget.querySelector("input"))||void 0===n||n.focus()},children:(0,o.jsxs)(K.mc,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(be.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:n=>{""===e.value&&n.currentTarget.setSelectionRange(n.currentTarget.value.length,n.currentTarget.value.length)},onChange:n=>{let t=n.target.value;t.startsWith(".")&&(t="0".concat(t));const o=Number(t);Number.isNaN(o)||(t.startsWith("0")&&!t.startsWith("0.")?e.onChange(t.slice(1)):e.onChange(t))},style:{border:"none",fontSize:e.value.length>10?"26px":e.value.length>6?"34px":"50px",boxShadow:"none",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(()=>{let n=e.value.replace(".","").length;return e.value.includes(".")&&(n+=.3),"calc(".concat("".concat(Math.max(1,n),"ch")," + 6px)")})(),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(we.C,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.h,{y:"sm"}),(0,o.jsx)(K.mc,{flex:"row",center:"x",children:(0,o.jsxs)(Ce,{variant:"secondary",fullWidth:!0,style:{fontSize:l.J.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,o.jsxs)(K.mc,{flex:"row",center:"y",gap:"sm",children:[(0,o.jsx)(N.x,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(K.mc,{flex:"column",style:{gap:"4px"},children:[(0,o.jsx)(we.C,{token:e.token,chain:e.chain,size:"sm"}),null!==(n=t.data)&&void 0!==n&&n.name?(0,o.jsx)(q.E,{size:"xs",color:"secondaryText",children:t.data.name}):(0,o.jsx)(L.E,{width:"90px",height:l.J.xs})]})]}),(0,o.jsx)(C.D3D,{width:l.RK.sm,height:l.RK.sm,style:{marginLeft:"auto"}})]})})]})]})}const Ce=(0,$.A)(A.$n)((()=>{const e=(0,T.QP)();return{background:e.colors.tertiaryBg,border:"1px solid ".concat(e.colors.borderColor),justifyContent:"flex-start",transition:"background 0.3s",padding:l.YK.sm}}));var Te=t(66149),Se=t(89662),Ee=t(36583);function Fe(e){var n;const t=(0,u.r)(e.chain),r=(0,j.L)(),i=(0,h.X)({address:null===r||void 0===r?void 0:r.address,chain:e.chain,tokenAddress:(0,Y.r)(e.token)?void 0:e.token.address,client:e.client});return(0,o.jsxs)(K.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:l.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",minHeight:"64px",alignItems:"center"},children:[(0,o.jsxs)(A.$n,{variant:"ghost",onClick:e.onSelectToken,gap:"sm",style:{paddingInline:l.YK.sm,paddingBlock:l.YK.sm,minWidth:"50%",justifyContent:"flex-start"},disabled:e.freezeChainAndTokenSelection,children:[(0,o.jsx)(N.x,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(K.mc,{flex:"column",gap:"xxs",children:[(0,o.jsxs)(K.mc,{flex:"row",gap:"xs",center:"y",color:"primaryText",children:[(0,o.jsx)(we.C,{token:e.token,chain:e.chain,size:"sm"}),(0,o.jsx)(C.D3D,{width:l.RK.sm,height:l.RK.sm})]}),null!==(n=t.data)&&void 0!==n&&n.name?(0,o.jsxs)(q.E,{size:"xs",children:[" ",t.data.name]}):(0,o.jsx)(L.E,{width:"90px",height:l.J.xs})]})]}),(0,o.jsxs)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:l.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:l.YK.sm},children:[e.isLoading?(0,o.jsx)(L.E,{width:"120px",height:l.J.md,color:"borderColor"}):(0,o.jsx)(q.E,{size:"md",color:e.value?"primaryText":"secondaryText",style:{},children:(0,c.Z)(Number(e.value),4)||"--"}),(0,o.jsxs)(K.mc,{flex:"row",gap:"xxs",center:"y",color:"secondaryText",children:[(0,o.jsx)(Se.l,{size:l.J.xs}),i.data?(0,o.jsx)(q.E,{size:"xs",color:"secondaryText",weight:500,children:(0,Ee.j)(i.data,!0)}):(0,o.jsx)(L.E,{width:"70px",height:l.J.xs})]})]})]})}var Ae=t(17836),Re=t(38132);function Be(e){const n=(0,Re.Xw)(e.client);return n.data?(0,o.jsx)(ze,{...e,onViewPendingTx:e.onViewPendingTx,supportedDestinations:n.data,buyForTx:e.buyForTx}):(0,o.jsx)(b.x,{})}function We(e){const{payOptions:n}=e,[t,o]=(0,r.useState)(!1===n.buyWithCrypto?"creditCard":!1===n.buyWithFiat?"crypto":"creditCard"),[i,s]=(0,r.useState)({type:"main"}),[a,c]=(0,r.useState)(),{drawerRef:d,drawerOverlayRef:l,onClose:u}=function(){const e=(0,r.useRef)(null),n=(0,r.useRef)(null);return{drawerRef:e,drawerOverlayRef:n,onClose:t=>{if(e.current){var o;const r={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},i=e.current.animate([{transform:"translateY(100%)",opacity:0}],r);null===(o=n.current)||void 0===o||o.animate([{opacity:0}],r),i.onfinish=t}else t()}}}();return{method:t,setMethod:o,screen:i,setScreen:s,drawerScreen:a,setDrawerScreen:c,drawerRef:d,drawerOverlayRef:l,closeDrawer:function(){u((()=>{c(void 0)}))},showMainScreen:function(){s({type:"main"})}}}function ze(e){var n,t,s;const{client:a,supportedDestinations:h,connectLocale:x,payOptions:m,buyForTx:p}=e,y=(0,j.L)(),f=(0,v.w)();(0,u.s)(h.map((e=>e.chain))||[],50);const{method:g,setMethod:b,screen:w,setScreen:k,drawerScreen:C,setDrawerScreen:T,drawerRef:S,drawerOverlayRef:E,closeDrawer:F,showMainScreen:B}=We({payOptions:m}),{tokenAmount:W,setTokenAmount:L,setHasEditedAmount:I,hasEditedAmount:P,toChain:N,setToChain:q,deferredTokenAmount:O,fromChain:V,setFromChain:U,toToken:Q,setToToken:$,fromToken:H,setFromToken:G,selectedCurrency:Z,setSelectedCurrency:ne}=function(e){var n,t,o,i,s,a;const l=(0,v.w)(),{payOptions:u,buyForTx:h,supportedDestinations:x}=e,m=(null===(n=u.prefillBuy)||void 0===n?void 0:n.amount)||(h?String((0,c.Z)(Number((0,d.Ce)(h.cost-h.balance)),4)):""),[p,y]=(0,r.useState)(!1),[f,g]=(0,r.useState)(m),j=(0,ve.o)(f,300),[b,w]=(0,r.useState)((null===(t=u.prefillBuy)||void 0===t?void 0:t.chain)||(null===h||void 0===h?void 0:h.tx.chain)||(null===(o=x.find((e=>e.chain.id===(null===l||void 0===l?void 0:l.id))))||void 0===o?void 0:o.chain)||je.n),[k,C]=(0,r.useState)((null===(i=u.prefillBuy)||void 0===i?void 0:i.token)||Y.g),[T,S]=(0,r.useState)(!1!==u.buyWithCrypto&&(null===(s=u.buyWithCrypto)||void 0===s||null===(s=s.prefillSource)||void 0===s?void 0:s.chain)||je.n),[E,F]=(0,r.useState)(!1!==u.buyWithCrypto&&(null===(a=u.buyWithCrypto)||void 0===a||null===(a=a.prefillSource)||void 0===a?void 0:a.token)||Y.g),[A,R]=(0,r.useState)(X._O);return{tokenAmount:f,setTokenAmount:g,hasEditedAmount:p,toChain:b,setToChain:w,deferredTokenAmount:j,fromChain:T,setFromChain:S,toToken:k,setToToken:C,fromToken:E,setFromToken:F,selectedCurrency:A,setHasEditedAmount:y,setSelectedCurrency:R}}({payOptions:m,buyForTx:p,supportedDestinations:h}),{amountNeeded:te}=function(e){const{buyForTx:n,hasEditedAmount:t,isMainScreen:o,setTokenAmount:i,account:s}=e,a=!t&&o,l=!o,[u,h]=(0,r.useState)(null===n||void 0===n?void 0:n.cost);return(0,r.useEffect)((()=>{if(!n||l)return;let e=!0;return async function t(){if(n&&e){try{const t=await(0,fe.j)(n.tx,null===s||void 0===s?void 0:s.address);if(!e)return;if(h(t),a&&t>n.balance){const e=String((0,c.Z)(Number((0,d.Ce)(t-n.balance)),4));i(e)}}catch{}await(0,ge.u)(3e4),t()}}(),()=>{e=!1}}),[n,a,i,l,s]),{amountNeeded:u}}({setTokenAmount:L,buyForTx:p,hasEditedAmount:P,isMainScreen:"main"===w.type,account:y}),oe=f&&W,re=(0,Re.mC)({client:e.client,destinationChainId:N.id,destinationTokenAddress:(0,Y.r)(Q)?i.DG:Q.address}),ie=(0,r.useMemo)((()=>Ie(h,m,e.supportedTokens)),[e.supportedTokens,h,m]),se=(0,r.useMemo)((()=>{if(re.data)return Ie(re.data,m,e.supportedTokens)}),[e.supportedTokens,re.data,m]),{showPaymentSelection:ae}=function(e){const{payOptions:n,supportedDestinations:t,toChain:o,toToken:s,method:a,setMethod:c}=e,{fiat:d,swap:l}=function(){const e=t.find((e=>e.chain.id===o.id));if(!e)return{fiat:!0,swap:!0};const n=(0,Y.r)(s)?i.DG:s.address,r=e.tokens.find((e=>e.address.toLowerCase()===n.toLowerCase()));return r?{fiat:r.buyWithFiatEnabled,swap:r.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}(),u=!1!==n.buyWithFiat&&d,h=!1!==n.buyWithCrypto&&l;return(0,r.useEffect)((()=>{(u||h)&&("creditCard"!==a||u||c("crypto"),"crypto"!==a||h||c("creditCard"))}),[u,h,a,c]),{showPaymentSelection:u&&h}}({payOptions:m,supportedDestinations:h,toChain:N,toToken:Q,method:g,setMethod:b});if("node"===w.type)return w.node;if("select-currency"===w.type)return(0,o.jsx)(ee,{onSelect:e=>{B(),ne(e)},onBack:B});if("screen-id"===w.type&&"select-to-token"===w.name){var ce,de;const n=h.map((e=>e.chain));return!1===(null===(ce=m.prefillBuy)||void 0===ce||null===(ce=ce.allowEdits)||void 0===ce?void 0:ce.token)?(0,o.jsx)(Pe,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:q,showMainScreen:B}):(0,o.jsx)(_.T,{onBack:B,tokenList:((null!==N&&void 0!==N&&N.id?ie[N.id]:void 0)||[]).filter((e=>e.address!==i.DG)),onTokenSelect:e=>{$(e),B()},chain:N,chainSelection:!1!==(null===(de=m.prefillBuy)||void 0===de||null===(de=de.allowEdits)||void 0===de?void 0:de.chain)?{chains:n,select:e=>{q(e)}}:void 0,connectLocale:x,client:a})}if("screen-id"===w.type&&"select-from-token"===w.name&&re.data&&se){var le,ue;const n=re.data.map((e=>e.chain));return!1!==m.buyWithCrypto&&!1===(null===(le=m.buyWithCrypto)||void 0===le||null===(le=le.prefillSource)||void 0===le||null===(le=le.allowEdits)||void 0===le?void 0:le.token)?(0,o.jsx)(Pe,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:U,showMainScreen:B}):(0,o.jsx)(_.T,{onBack:B,tokenList:((null!==V&&void 0!==V&&V.id?se[V.id]:void 0)||[]).filter((e=>e.address!==i.DG)),onTokenSelect:e=>{G(e),k({type:"main"})},chain:V,chainSelection:!1!==m.buyWithCrypto&&!1!==(null===(ue=m.buyWithCrypto)||void 0===ue||null===(ue=ue.prefillSource)||void 0===ue||null===(ue=ue.allowEdits)||void 0===ue?void 0:ue.chain)?{chains:re.data.map((e=>e.chain)),select:e=>U(e)}:void 0,connectLocale:x,client:a})}return(0,o.jsx)(K.mc,{animate:"fadein",children:(0,o.jsxs)("div",{onClick:e=>{C&&S.current&&!S.current.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),F())},children:[C&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(z,{ref:E}),(0,o.jsx)(R,{ref:S,close:F,children:(0,o.jsx)(D.X,{children:C})})]}),(0,o.jsxs)(K.mc,{p:"lg",style:{paddingBottom:0},children:[(0,o.jsx)(K.rQ,{title:e.buyForTx?"Not enough ".concat(e.buyForTx.tokenSymbol):"Buy",onBack:e.onBack}),(0,o.jsx)(M.h,{y:"lg"}),!oe&&(0,o.jsx)(M.h,{y:"xl"}),te&&e.buyForTx?(0,o.jsx)(Me,{amountNeeded:String((0,c.Z)(Number((0,d.Ce)(te)),4)),buyForTx:e.buyForTx,client:a}):null,(0,o.jsx)(ke,{value:W,onChange:async e=>{I(!0),L(e)},freezeAmount:!1===(null===(n=m.prefillBuy)||void 0===n||null===(n=n.allowEdits)||void 0===n?void 0:n.amount),freezeChainAndToken:!1===(null===(t=m.prefillBuy)||void 0===t||null===(t=t.allowEdits)||void 0===t?void 0:t.chain)&&!1===(null===(s=m.prefillBuy)||void 0===s||null===(s=s.allowEdits)||void 0===s?void 0:s.token),token:Q,chain:N,onSelectToken:()=>{k({type:"screen-id",name:"select-to-token"})},client:e.client,hideTokenSelector:!!e.buyForTx})]}),ae?(0,o.jsx)(M.h,{y:"lg"}):(0,o.jsx)(M.h,{y:"md"}),oe&&(0,o.jsxs)(o.Fragment,{children:[ae&&(0,o.jsxs)(K.mc,{px:"lg",children:[(0,o.jsx)(J,{selected:g,onSelect:b}),(0,o.jsx)(M.h,{y:"md"})]}),"crypto"===g&&y&&f&&(0,o.jsx)(De,{...e,setScreen:k,setDrawerScreen:T,tokenAmount:O,toChain:N,toToken:Q,fromChain:V,fromToken:H,showFromTokenSelector:()=>{k({type:"screen-id",name:"select-from-token"})},account:y,activeChain:f}),"creditCard"===g&&y&&(0,o.jsx)(Le,{...e,setScreen:k,setDrawerScreen:T,tokenAmount:O,toChain:N,toToken:Q,closeDrawer:F,selectedCurrency:Z,showCurrencySelector:()=>{k({type:"select-currency"})},account:y}),(0,o.jsx)(M.h,{y:"sm"})]}),(0,o.jsxs)(K.mc,{px:"lg",flex:"column",gap:"sm",children:[!oe&&(0,o.jsx)(o.Fragment,{children:!y&&e.connectButton?(0,o.jsx)("div",{children:e.connectButton}):(0,o.jsx)(A.$n,{variant:"accent",fullWidth:!0,disabled:!0,"data-disable":!0,children:"Continue"})}),y&&(0,o.jsx)(A.$n,{variant:"outline",fullWidth:!0,style:{padding:l.YK.xs,fontSize:l.J.sm},onClick:e.onViewPendingTx,children:"View all transactions"})]}),(0,o.jsx)(M.h,{y:"lg"})]})})}function De(e){var n,t,r,s,a;const{setDrawerScreen:c,setScreen:d,account:l,client:u,toChain:p,tokenAmount:y,toToken:f,fromChain:g,fromToken:j,showFromTokenSelector:v,payOptions:b}=e,w=(0,h.X)({address:l.address,chain:g,tokenAddress:(0,Y.r)(j)?void 0:j.address,client:u}),k=!y||g.id===p.id&&j===f?void 0:{fromAddress:l.address,fromChainId:g.id,fromTokenAddress:(0,Y.r)(j)?i.DG:j.address,toChainId:p.id,toTokenAddress:(0,Y.r)(f)?i.DG:f.address,toAmount:y,client:u},C=(T=k,S={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,x.I)({...S,queryKey:["buyWithCryptoQuote",T],queryFn:()=>{if(!T)throw new Error("Swap params are required");return(0,m.c)(T)},enabled:!!T,retry:(e,n)=>!(e>3)&&!n.message.includes("Minimum purchase")}));var T,S;const E=null===(n=C.data)||void 0===n?void 0:n.swapDetails.fromAmount,F=!!E&&!!w.data&&Number(w.data.displayValue)<Number(E),R=!C.data||F,B=e.activeChain.id!==g.id;const W=!1!==b.buyWithCrypto?null===(t=b.buyWithCrypto)||void 0===t?void 0:t.prefillSource:void 0;return(0,o.jsxs)(K.mc,{px:"lg",flex:"column",gap:"md",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(Fe,{value:E||"",onSelectToken:v,chain:g,token:j,isLoading:C.isLoading&&!E,client:u,freezeChainAndTokenSelection:!1===(null===W||void 0===W||null===(r=W.allowEdits)||void 0===r?void 0:r.chain)&&!1===(null===W||void 0===W||null===(s=W.allowEdits)||void 0===s?void 0:s.token)}),(0,o.jsx)(U,{quoteIsLoading:C.isLoading,estimatedSeconds:null===(a=C.data)||void 0===a?void 0:a.swapDetails.estimated.durationSeconds,onViewFees:function(){C.data&&c((0,o.jsxs)("div",{children:[(0,o.jsx)(q.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(Te.h,{quote:C.data,align:"left"})]}))}})]}),C.error&&(0,o.jsx)(q.E,{color:"danger",size:"sm",center:!0,children:function(e){const n="Unable to get price quote";try{if(e instanceof Error&&e.message.includes("Minimum")){return e.message.replace("Fetch failed: Error: ","")}return n}catch{return n}}(C.error)}),!B||C.isLoading||F||C.error?(0,o.jsx)(A.$n,{variant:R?"outline":"accent",fullWidth:!0,"data-disabled":R,disabled:R,onClick:async()=>{R||C.data&&d({type:"node",node:(0,o.jsx)(Ae.K,{isBuyForTx:!!e.buyForTx,isEmbed:e.isEmbed,client:u,onBack:()=>{d({type:"main"})},buyWithCryptoQuote:C.data,account:l,onViewPendingTx:e.onViewPendingTx,isFiatFlow:!1,onDone:e.onDone,onTryAgain:()=>{d({type:"main"}),C.refetch()}})})},gap:"xs",children:F?(0,o.jsx)(q.E,{color:"danger",children:"Not Enough Funds"}):C.isLoading?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.y,{size:"sm",color:"accentText"}),"Getting price quote"]}):"Continue"}):(0,o.jsx)(P.b,{variant:"accent",fullWidth:!0,chain:g})]})}function Le(e){var n,t;const{toToken:r,tokenAmount:s,account:c,client:d,setScreen:l,setDrawerScreen:u,toChain:h,showCurrencySelector:x,selectedCurrency:m}=e,p=e.payOptions.buyWithFiat,y=f(!1!==p&&s?{fromCurrencySymbol:m.shorthand,toChainId:h.id,toAddress:c.address,toTokenAddress:(0,Y.r)(r)?i.DG:r.address,toAmount:s,client:d,isTestMode:null===p||void 0===p?void 0:p.testMode}:void 0);const g=!y.data;return(0,o.jsxs)(K.mc,{px:"lg",flex:"column",gap:"md",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(H,{isLoading:y.isLoading,value:null===(n=y.data)||void 0===n?void 0:n.fromCurrencyWithFees.amount,client:d,currency:m,onSelectCurrency:x}),(0,o.jsx)(U,{quoteIsLoading:y.isLoading,estimatedSeconds:null===(t=y.data)||void 0===t?void 0:t.estimatedDurationSeconds,onViewFees:function(){y.data&&u((0,o.jsxs)("div",{children:[(0,o.jsx)(q.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(Te.C,{quote:y.data})]}))}})]}),y.error&&(0,o.jsx)("div",{children:function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){const n=e.error;return["Minimum purchase amount is $".concat(n.data.minimumAmountUSDCents/100),"Requested amount is $".concat(n.data.requestedAmountUSDCents/100)]}}catch{}return["Unable to get price quote"]}(y.error).map((e=>(0,o.jsx)(q.E,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e)))}),(0,o.jsx)(A.$n,{variant:g?"outline":"accent","data-disabled":g,disabled:g,fullWidth:!0,onClick:function(){if(!y.data)return;let n=null;a(y.data)||(n=te(y.data.onRampLink,"string"===typeof e.theme?e.theme:e.theme.type),(0,oe.b)({type:"fiat",intentId:y.data.intentId})),l({type:"node",node:(0,o.jsx)(ye,{isBuyForTx:!!e.buyForTx,quote:y.data,onBack:()=>{l({type:"main"})},client:d,testMode:!1!==p&&(null===p||void 0===p?void 0:p.testMode)||!1,theme:"string"===typeof e.theme?e.theme:e.theme.type,onViewPendingTx:e.onViewPendingTx,openedWindow:n,onDone:e.onDone,isEmbed:e.isEmbed})})},gap:"xs",children:y.isLoading?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.y,{size:"sm",color:"accentText"}),"Getting price quote"]}):"Continue"})]})}function Me(e){const n=(0,u.r)(e.buyForTx.tx.chain);return(0,o.jsxs)(K.mc,{children:[(0,o.jsx)(M.h,{y:"xs"}),(0,o.jsxs)(K.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(q.E,{size:"sm",children:"Amount Needed"}),(0,o.jsxs)(K.mc,{flex:"column",style:{alignItems:"flex-end"},children:[(0,o.jsxs)(K.mc,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsxs)(q.E,{color:"primaryText",size:"sm",children:[e.amountNeeded," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(N.x,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:Y.g})]}),(0,o.jsx)(M.h,{y:"xxs"}),n.data?(0,o.jsxs)(q.E,{size:"sm",children:[" ",n.data.name]}):(0,o.jsx)(L.E,{height:l.J.sm,width:"50px"})]})]}),(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(K.N1,{}),(0,o.jsx)(M.h,{y:"md"}),(0,o.jsxs)(K.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(q.E,{size:"sm",children:"Your Balance"}),(0,o.jsxs)(K.mc,{flex:"row",gap:"xs",children:[(0,o.jsxs)(q.E,{color:"primaryText",size:"sm",children:[(0,c.Z)(Number((0,d.Ce)(e.buyForTx.balance)),4)," ",e.buyForTx.tokenSymbol]}),(0,o.jsx)(N.x,{chain:e.buyForTx.tx.chain,client:e.client,size:"sm",token:Y.g})]})]}),(0,o.jsx)(M.h,{y:"md"}),(0,o.jsx)(K.N1,{}),(0,o.jsx)(M.h,{y:"lg"}),(0,o.jsx)(q.E,{center:!0,size:"sm",children:"Purchase"}),(0,o.jsx)(M.h,{y:"xxs"})]})}function Ie(e,n,t){const o={},r=!1===n.buyWithFiat,i=!1===n.buyWithCrypto;for(const s of e)o[s.chain.id]=s.tokens.filter((e=>!(!e.buyWithCryptoEnabled||!e.buyWithFiatEnabled)||!(!e.buyWithCryptoEnabled&&r)&&!(!e.buyWithFiatEnabled&&i)));if(t)for(const s in t){const e=Number(s),n=t[e];n&&(o[e]=n)}return o}function Pe(e){return(0,o.jsx)(O.H,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.showMainScreen,chains:e.chains,closeModal:e.showMainScreen,networkSelector:{renderChain:n=>(0,o.jsx)(O.O,{chain:n.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(n.chain),e.showMainScreen()},client:e.client,connectLocale:e.connectLocale})}})}}}]);
//# sourceMappingURL=18916.9257d383.chunk.js.map